## Spam Classifier
[![SkillFactory Data Science](https://img.shields.io/badge/SF-Data%20Science-brightgreen)](https://skillfactory.ru/data-science)


Задача этого проекта — написать классификатор спама.  
Необходимо было создать и обучить модель, предсказывающую, является ли текст спамом.  
Кроме того, предлагалось обернуть модель в сервис так, чтобы почтовые сервисы могли с ней взаимодействовать – присылать письма и получать ответ в виде «СПАМ / НЕ СПАМ».

## Теоретические основы

Байесовская фильтрация спама — метод, основанный на применении [наивного байесовского классификатора](https://ru.wikipedia.org/wiki/%D0%9D%D0%B0%D0%B8%D0%B2%D0%BD%D1%8B%D0%B9_%D0%B1%D0%B0%D0%B9%D0%B5%D1%81%D0%BE%D0%B2%D1%81%D0%BA%D0%B8%D0%B9_%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80) (Naive Bayes Classifier), опирающегося на прямое использование теоремы Байеса (Bayes' theorem):

<img src="https://telegra.ph/file/599592d2978e44967f237.png" width=550>

Чтобы принять решение о том, к какому классу относится email, нужно рассчитать вероятности для всех классов и выбрать класс с самой высокой вероятностью.  

При использовании наивного байесовского метода мы предполагаем, что все слова в тексте не находятся в зависимости друг от друга (в отличие от естественного языка).
Такое допущение позволяет нам аппроксимировать условную вероятность текста **P(B|A)** через произведение условных вероятностей всех слов, входящих в текст.
Условную вероятность слова можно посчитать как количество раз, которое это слово встречается в текстах, принадлежащих к определенному классу, поделенное на количество всех уникальных слов.

Здесь ранее не известные слова могут стать проблемой, т.к. они превращают общую вероятность текста в 0. 
Классический способ избежать этого - добавить единицу к частоте каждого слова (словно мы встречаем каждое слово на 1 больше раз).

Для обучения классификатора нам нужен набор данных с текстами, размеченными как «СПАМ» и «НЕ СПАМ». 
После обработки и получения всей необходимой статистики, модель может определить класс любого предложенного ей нового текста.

## Flask app

В созданном Flask-приложении модель обучается на датасете: [Spam or Not Spam Dataset](https://www.kaggle.com/ozlerhakan/spam-or-not-spam-dataset). 

Для работы потребуются библиотеки `numpy`, `pandas`, а также установленный пакет `Flask`.

Для запуска склонируйте репозиторий и выполните следующие команды из директории "Classifier"  
_(для Windows вместо 'export' следует писать 'set'):_
```
$ export FLASK_APP=run.py  # 
$ python -m flask run
```
Предложенный веб-адрес будет вести на главную страницу приложения.
